# ErpCore 專案運行說明

## 前置需求

### 後端需求
1. **.NET 7 SDK** - 請從 [Microsoft 官網](https://dotnet.microsoft.com/download/dotnet/7.0) 下載並安裝
2. **SQL Server** - 資料庫伺服器（可選，開發環境可使用 LocalDB）
3. **Visual Studio 2022** 或 **Visual Studio Code**（推薦）

### 前端需求
1. **Node.js** (v16 或以上) - 請從 [Node.js 官網](https://nodejs.org/) 下載並安裝
2. **npm** 或 **yarn** - 套件管理工具（通常隨 Node.js 一起安裝）

## 快速開始

### 1. 檢查環境

#### 檢查 .NET SDK
```powershell
dotnet --version
```
應該顯示 `7.0.x` 或以上版本

#### 檢查 Node.js
```powershell
node --version
```
應該顯示 `v16.x.x` 或以上版本

#### 檢查 npm
```powershell
npm --version
```

### 2. 還原後端套件

```powershell
cd ErpCore
dotnet restore
```

### 3. 建置後端專案

```powershell
dotnet build ErpCore.sln
```

### 4. 設定資料庫連線

編輯 `src/ErpCore.Api/appsettings.json`，修改資料庫連線字串：

```json
{
  "ConnectionStrings": {
    "DefaultConnection": "Server=localhost;Database=ErpCore;User Id=sa;Password=YourPassword;TrustServerCertificate=true;"
  }
}
```

### 5. 執行資料庫腳本

在 SQL Server 中執行 `database/Scripts/` 目錄下的所有 SQL 腳本，建立資料表結構。

### 6. 運行後端 API

```powershell
cd src/ErpCore.Api
dotnet run
```

後端 API 將在以下網址運行：
- HTTPS: https://localhost:5001
- HTTP: http://localhost:5000
- Swagger UI: https://localhost:5001/swagger

### 7. 安裝前端套件

開啟新的終端視窗：

```powershell
cd ErpCore/src/ErpCore.Web
npm install
```

### 8. 運行前端開發伺服器

```powershell
npm run serve
```

前端應用將在以下網址運行：
- http://localhost:8080

## 使用 Visual Studio 運行

### 後端
1. 開啟 `ErpCore.sln`
2. 設定 `ErpCore.Api` 為啟動專案
3. 按 F5 或點擊「執行」按鈕

### 前端
1. 在 Visual Studio Code 中開啟 `ErpCore/src/ErpCore.Web` 目錄
2. 開啟終端，執行 `npm run serve`

## 使用 Docker 運行（可選）

### 使用 Docker Compose

```powershell
cd ErpCore/docker
docker-compose up -d
```

## 常見問題

### 1. dotnet 命令找不到
- 確認已安裝 .NET 7 SDK
- 重新啟動終端或電腦
- 檢查環境變數 PATH 是否包含 .NET SDK 路徑

### 2. 資料庫連線失敗
- 確認 SQL Server 服務正在運行
- 檢查連線字串是否正確
- 確認資料庫已建立

### 3. 前端套件安裝失敗
- 確認 Node.js 版本符合需求
- 嘗試清除快取：`npm cache clean --force`
- 刪除 `node_modules` 資料夾後重新安裝

### 4. 端口被占用
- 修改 `launchSettings.json` 中的端口設定
- 或關閉占用端口的其他應用程式

## 專案結構

```
ErpCore/
├── src/
│   ├── ErpCore.Api/          # Web API 後端
│   ├── ErpCore.Application/  # 應用層
│   ├── ErpCore.Domain/       # 領域層
│   ├── ErpCore.Infrastructure/ # 基礎設施層
│   ├── ErpCore.Shared/       # 共用類別庫
│   └── ErpCore.Web/          # Vue 前端
├── database/                 # 資料庫腳本
├── tests/                    # 測試專案
└── docs/                     # 文件
```

## 開發規範

- 所有程式碼都有 try-catch 和 NLog 日誌記錄
- 資料庫存取使用 Dapper
- API 命名統一使用 PascalCase
- Vue 前端遵循所有 C# API 欄位命名
- 前端使用主色系 #198754

## 更多資訊

詳細的開發文件請參考 `docs/` 目錄。

