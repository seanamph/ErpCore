# SYS0999 - 系統作業與功能列表查詢 開發計劃

## 一、功能概述

### 1.1 功能說明
- **功能代碼**: SYS0999
- **功能名稱**: 系統作業與功能列表查詢
- **功能描述**: 提供系統作業與功能列表的查詢功能，可選擇主系統項目，然後顯示該系統下的所有作業與功能列表（用於出庫）
- **參考舊程式**: 
  - `WEB/IMS_CORE/ASP/SYS0000/SYS0999_FQ.asp` (查詢條件頁面)
  - `WEB/IMS_CORE/ASP/SYS0000/SYS0999_PR.asp` (報表顯示頁面)

### 1.2 業務需求
- 選擇主系統項目
- 顯示該系統下的所有作業與功能列表
- 支援作業與功能的瀏覽
- 支援報表列印功能（用於出庫）
- 僅供查詢，不支援新增、修改、刪除操作

---

## 二、資料庫設計 (Schema)

### 2.1 主要資料表

與 SYS0810 共用相同的資料表結構，請參考 SYS0810 的資料庫設計：
- `Systems` - 主系統項目表
- `Programs` - 系統作業表
- `Buttons` - 系統功能按鈕表

### 2.2 資料字典

與 SYS0810 相同，請參考 SYS0810 的資料字典。

---

## 三、後端 API 設計

### 3.1 API 端點列表

#### 3.1.1 查詢主系統列表
- **HTTP 方法**: `GET`
- **路徑**: `/api/v1/systems`
- **說明**: 查詢所有主系統項目列表，用於下拉選單
- **回應格式**: 標準列表回應格式

#### 3.1.2 查詢系統作業與功能列表（出庫用）
- **HTTP 方法**: `GET`
- **路徑**: `/api/v1/systems/{sysId}/programs-and-buttons/export`
- **說明**: 根據系統代碼查詢該系統下的所有作業與功能列表（用於出庫）
- **路徑參數**:
  - `sysId`: 系統代碼
- **回應格式**: 與 SYS0810 相同

#### 3.1.3 匯出系統作業與功能列表報表（出庫用）
- **HTTP 方法**: `POST`
- **路徑**: `/api/v1/systems/{sysId}/programs-and-buttons/export-report`
- **說明**: 匯出系統作業與功能列表報表 (Excel/PDF)（用於出庫）
- **路徑參數**:
  - `sysId`: 系統代碼
- **回應格式**: 檔案下載

---

## 四、前端 UI 設計

### 4.1 頁面結構

#### 4.1.1 系統作業與功能列表查詢頁面（出庫用） (`SystemProgramButtonExportQuery.vue`)
- **路徑**: `/system/programs-and-buttons/export`
- **功能**: 選擇主系統項目，顯示該系統下的所有作業與功能列表（用於出庫）
- **主要元件**:
  - 系統選擇下拉選單 (SystemSelect)
  - 作業與功能列表顯示 (ProgramButtonList)
  - 報表列印按鈕（出庫用）

### 4.2 主要元件

#### 4.2.1 系統選擇下拉選單
- 顯示所有主系統項目
- 選擇後自動載入該系統的作業與功能列表

#### 4.2.2 作業與功能列表顯示
- 以樹狀結構顯示：系統 > 作業 > 功能按鈕
- 顯示作業代碼、作業名稱、功能按鈕代碼、功能按鈕名稱
- 支援展開/收合
- 針對出庫用途優化顯示

---

## 五、開發時程

**總計**: 8天
- 資料庫設計: 1天（共用SYS0810的資料表）
- 後端API開發: 2天
- 前端UI開發: 3天
- 測試與修正: 2天

---

## 六、注意事項

### 6.1 安全性
- 必須驗證使用者權限
- 僅供查詢，不支援新增、修改、刪除操作

### 6.2 效能
- 大量作業與功能時需考慮效能
- 可使用分頁或虛擬滾動優化

### 6.3 業務邏輯
- 僅顯示啟用的系統、作業、功能按鈕
- 按照排序序號排序顯示
- 針對出庫用途優化報表格式

### 6.4 與 SYS0810 的差異
- SYS0810 用於一般查詢
- SYS0999 用於出庫用途，報表格式可能有所不同

---

## 七、測試案例

### 7.1 單元測試
- [ ] 查詢主系統列表成功
- [ ] 查詢系統作業與功能列表成功
- [ ] 匯出 Excel 報表成功（出庫用）
- [ ] 匯出 PDF 報表成功（出庫用）

---

## 八、參考資料

### 8.1 舊程式碼
- `WEB/IMS_CORE/ASP/SYS0000/SYS0999_FQ.asp`
- `WEB/IMS_CORE/ASP/SYS0000/SYS0999_PR.asp`

### 8.2 相關功能
- CFG0410 - 主系統項目資料維護
- CFG0430 - 系統作業資料維護
- CFG0440 - 系統功能按鈕資料維護
- SYS0780 - 系統作業與功能列表查詢
- SYS0810 - 系統作業與功能列表查詢

---

**文件版本**: v1.0  
**建立日期**: 2024-01-01  
**最後更新**: 2024-01-01

