# SYS0310 - 角色系統權限設定 開發計劃

## 一、功能概述

### 1.1 功能說明
- **功能代碼**: SYS0310
- **功能名稱**: 角色系統權限設定
- **功能描述**: 為指定角色設定系統、選單、作業、按鈕等層級的權限，管理角色對系統功能的存取控制
- **參考舊程式**: 
  - `WEB/IMS_CORE/ASP/SYS0000/SYS0310_FI.ASP` (新增)
  - `WEB/IMS_CORE/ASP/SYS0000/SYS0310_FU.ASP` (修改)
  - `WEB/IMS_CORE/ASP/SYS0000/SYS0310_FD.ASP` (刪除)
  - `WEB/IMS_CORE/ASP/SYS0000/SYS0310_FQ.ASP` (查詢)
  - `WEB/IMS_CORE/ASP/SYS0000/SYS0310_FB.ASP` (瀏覽)
  - `WEB/IMS_CORE/ASP/SYS0000/SYS0310_SYS_LIST.asp` (系統列表)
  - `WEB/IMS_CORE/ASP/SYS0000/SYS0310_SET_SYS_AC.asp` (設定系統權限)
  - `WEB/IMS_CORE/ASP/SYS0000/SYS0310_SET_PROG_AC.asp` (設定作業權限)
  - `WEB/IMS_CORE/ASP/SYS0000/SYS0310_SET_MENU_AC.asp` (設定選單權限)
  - `WEB/IMS_CORE/ASP/SYS0000/SYS0310_SET_BUTTON_AC.asp` (設定按鈕權限)
  - `IMS3/HANSHIN/IMS3/SYS0000/SYS0310_SET_SYS_AC.aspx.cs`
  - `IMS3/HANSHIN/RSL_CLASS/IMS3_SYS/MNG_ROLE_BUTTON.cs`

### 1.2 業務需求
- 為指定角色設定系統層級權限（全選/未選）
- 為指定角色設定選單層級權限
- 為指定角色設定作業層級權限
- 為指定角色設定按鈕層級權限
- 支援批量設定權限
- 支援權限繼承（系統→選單→作業→按鈕）
- 查看角色已設定的權限列表
- 支援權限的查詢、新增、修改、刪除

---

## 二、資料庫設計 (Schema)

### 2.1 主要資料表: `RoleButtons` (角色按鈕權限)

```sql
CREATE TABLE [dbo].[RoleButtons] (
    [TKey] BIGINT NOT NULL PRIMARY KEY IDENTITY(1,1),
    [RoleId] NVARCHAR(50) NOT NULL,
    [ButtonKey] BIGINT NOT NULL, -- 對應到 Buttons 表的 TKey
    [CreatedBy] NVARCHAR(50) NULL,
    [CreatedAt] DATETIME2 NOT NULL DEFAULT GETDATE(),
    [CreatedPriority] INT NULL,
    [CreatedGroup] NVARCHAR(50) NULL,
    CONSTRAINT [PK_RoleButtons] PRIMARY KEY CLUSTERED ([TKey] ASC),
    CONSTRAINT [FK_RoleButtons_Roles] FOREIGN KEY ([RoleId]) REFERENCES [dbo].[Roles] ([RoleId]) ON DELETE CASCADE,
    CONSTRAINT [FK_RoleButtons_Buttons] FOREIGN KEY ([ButtonKey]) REFERENCES [dbo].[Buttons] ([TKey]) ON DELETE CASCADE
);

-- 索引
CREATE NONCLUSTERED INDEX [IX_RoleButtons_RoleId] ON [dbo].[RoleButtons] ([RoleId]);
CREATE NONCLUSTERED INDEX [IX_RoleButtons_ButtonKey] ON [dbo].[RoleButtons] ([ButtonKey]);
CREATE UNIQUE NONCLUSTERED INDEX [IX_RoleButtons_RoleId_ButtonKey] ON [dbo].[RoleButtons] ([RoleId], [ButtonKey]);
```

### 2.2 相關資料表

#### 2.2.1 `Roles` - 角色基本資料
```sql
-- 參考 SYS0210 開發計劃
```

#### 2.2.2 `Systems` - 系統主檔
```sql
CREATE TABLE [dbo].[Systems] (
    [SystemId] NVARCHAR(50) NOT NULL PRIMARY KEY,
    [SystemName] NVARCHAR(100) NOT NULL,
    [SystemNote] NVARCHAR(500) NULL,
    [Status] NVARCHAR(10) NOT NULL DEFAULT '1', -- 1:啟用, 0:停用
    [CreatedBy] NVARCHAR(50) NULL,
    [CreatedAt] DATETIME2 NOT NULL DEFAULT GETDATE(),
    [UpdatedBy] NVARCHAR(50) NULL,
    [UpdatedAt] DATETIME2 NULL,
    CONSTRAINT [PK_Systems] PRIMARY KEY CLUSTERED ([SystemId] ASC)
);
```

#### 2.2.3 `Menus` - 選單主檔
```sql
CREATE TABLE [dbo].[Menus] (
    [MenuId] NVARCHAR(50) NOT NULL PRIMARY KEY,
    [SystemId] NVARCHAR(50) NOT NULL,
    [MenuName] NVARCHAR(100) NOT NULL,
    [MenuNote] NVARCHAR(500) NULL,
    [ParentMenuId] NVARCHAR(50) NULL,
    [SortOrder] INT NULL DEFAULT 0,
    [Status] NVARCHAR(10) NOT NULL DEFAULT '1',
    [CreatedBy] NVARCHAR(50) NULL,
    [CreatedAt] DATETIME2 NOT NULL DEFAULT GETDATE(),
    CONSTRAINT [PK_Menus] PRIMARY KEY CLUSTERED ([MenuId] ASC),
    CONSTRAINT [FK_Menus_Systems] FOREIGN KEY ([SystemId]) REFERENCES [dbo].[Systems] ([SystemId]),
    CONSTRAINT [FK_Menus_ParentMenu] FOREIGN KEY ([ParentMenuId]) REFERENCES [dbo].[Menus] ([MenuId])
);
```

#### 2.2.4 `Programs` - 作業主檔
```sql
CREATE TABLE [dbo].[Programs] (
    [ProgramId] NVARCHAR(50) NOT NULL PRIMARY KEY,
    [MenuId] NVARCHAR(50) NOT NULL,
    [ProgramName] NVARCHAR(100) NOT NULL,
    [ProgramNote] NVARCHAR(500) NULL,
    [ProgramUrl] NVARCHAR(500) NULL,
    [Status] NVARCHAR(10) NOT NULL DEFAULT '1',
    [SortOrder] INT NULL DEFAULT 0,
    [CreatedBy] NVARCHAR(50) NULL,
    [CreatedAt] DATETIME2 NOT NULL DEFAULT GETDATE(),
    CONSTRAINT [PK_Programs] PRIMARY KEY CLUSTERED ([ProgramId] ASC),
    CONSTRAINT [FK_Programs_Menus] FOREIGN KEY ([MenuId]) REFERENCES [dbo].[Menus] ([MenuId])
);
```

#### 2.2.5 `Buttons` - 按鈕主檔
```sql
CREATE TABLE [dbo].[Buttons] (
    [TKey] BIGINT NOT NULL PRIMARY KEY IDENTITY(1,1),
    [ProgramId] NVARCHAR(50) NOT NULL,
    [ButtonName] NVARCHAR(100) NOT NULL,
    [ButtonKey] NVARCHAR(50) NULL, -- 按鈕代碼
    [Funs] NVARCHAR(50) NULL, -- 功能代碼 (I:新增, U:修改, D:刪除, Q:查詢, P:報表等)
    [PageId] NVARCHAR(50) NULL,
    [Status] NVARCHAR(10) NOT NULL DEFAULT '1',
    [CreatedBy] NVARCHAR(50) NULL,
    [CreatedAt] DATETIME2 NOT NULL DEFAULT GETDATE(),
    CONSTRAINT [PK_Buttons] PRIMARY KEY CLUSTERED ([TKey] ASC),
    CONSTRAINT [FK_Buttons_Programs] FOREIGN KEY ([ProgramId]) REFERENCES [dbo].[Programs] ([ProgramId])
);

-- 索引
CREATE NONCLUSTERED INDEX [IX_Buttons_ProgramId] ON [dbo].[Buttons] ([ProgramId]);
CREATE NONCLUSTERED INDEX [IX_Buttons_ButtonKey] ON [dbo].[Buttons] ([ButtonKey]);
```

### 2.3 資料字典

#### RoleButtons 表

| 欄位名稱 | 資料類型 | 長度 | 允許NULL | 預設值 | 說明 | 備註 |
|---------|---------|------|---------|--------|------|------|
| TKey | BIGINT | - | NO | IDENTITY | 主鍵 | 自動遞增 |
| RoleId | NVARCHAR | 50 | NO | - | 角色代碼 | 外鍵至 Roles |
| ButtonKey | BIGINT | - | NO | - | 按鈕主鍵 | 外鍵至 Buttons.TKey |
| CreatedBy | NVARCHAR | 50 | YES | - | 建立者 | - |
| CreatedAt | DATETIME2 | - | NO | GETDATE() | 建立時間 | - |
| CreatedPriority | INT | - | YES | - | 建立者等級 | - |
| CreatedGroup | NVARCHAR | 50 | YES | - | 建立者群組 | - |

---

## 三、後端 API 設計

### 3.1 API 端點列表

#### 3.1.1 查詢角色權限列表
- **HTTP 方法**: `GET`
- **路徑**: `/api/v1/roles/{roleId}/permissions`
- **說明**: 查詢指定角色的權限列表，支援分頁、排序、篩選
- **路徑參數**:
  - `roleId`: 角色代碼
- **請求參數**:
  ```json
  {
    "pageIndex": 1,
    "pageSize": 20,
    "sortField": "ButtonKey",
    "sortOrder": "ASC",
    "filters": {
      "systemId": "",
      "menuId": "",
      "programId": "",
      "buttonKey": ""
    }
  }
  ```
- **回應格式**:
  ```json
  {
    "success": true,
    "code": 200,
    "message": "查詢成功",
    "data": {
      "items": [
        {
          "tKey": 1,
          "roleId": "ROLE001",
          "buttonKey": 1001,
          "systemId": "SYS001",
          "systemName": "系統管理",
          "menuId": "MENU001",
          "menuName": "使用者管理",
          "programId": "SYS0110",
          "programName": "使用者基本資料維護",
          "buttonName": "新增",
          "funs": "I",
          "createdBy": "ADMIN",
          "createdAt": "2024-01-01T10:00:00"
        }
      ],
      "totalCount": 100,
      "pageIndex": 1,
      "pageSize": 20,
      "totalPages": 5
    },
    "timestamp": "2024-01-01T00:00:00Z"
  }
  ```

#### 3.1.2 查詢角色系統列表
- **HTTP 方法**: `GET`
- **路徑**: `/api/v1/roles/{roleId}/systems`
- **說明**: 查詢指定角色可存取的系統列表，包含權限統計
- **路徑參數**:
  - `roleId`: 角色代碼
- **回應格式**:
  ```json
  {
    "success": true,
    "code": 200,
    "message": "查詢成功",
    "data": [
      {
        "systemId": "SYS001",
        "systemName": "系統管理",
        "totalButtons": 50,
        "authorizedButtons": 30,
        "isFullyAuthorized": false,
        "authorizedRate": 0.6
      }
    ],
    "timestamp": "2024-01-01T00:00:00Z"
  }
  ```

#### 3.1.3 查詢角色選單列表
- **HTTP 方法**: `GET`
- **路徑**: `/api/v1/roles/{roleId}/menus`
- **說明**: 查詢指定角色在指定系統下的選單列表
- **路徑參數**:
  - `roleId`: 角色代碼
- **請求參數**:
  - `systemId`: 系統代碼（可選）
- **回應格式**:
  ```json
  {
    "success": true,
    "code": 200,
    "message": "查詢成功",
    "data": [
      {
        "menuId": "MENU001",
        "menuName": "使用者管理",
        "systemId": "SYS001",
        "totalButtons": 10,
        "authorizedButtons": 8,
        "isFullyAuthorized": false
      }
    ],
    "timestamp": "2024-01-01T00:00:00Z"
  }
  ```

#### 3.1.4 查詢角色作業列表
- **HTTP 方法**: `GET`
- **路徑**: `/api/v1/roles/{roleId}/programs`
- **說明**: 查詢指定角色在指定選單下的作業列表
- **路徑參數**:
  - `roleId`: 角色代碼
- **請求參數**:
  - `menuId`: 選單代碼（可選）
- **回應格式**:
  ```json
  {
    "success": true,
    "code": 200,
    "message": "查詢成功",
    "data": [
      {
        "programId": "SYS0110",
        "programName": "使用者基本資料維護",
        "menuId": "MENU001",
        "totalButtons": 5,
        "authorizedButtons": 5,
        "isFullyAuthorized": true
      }
    ],
    "timestamp": "2024-01-01T00:00:00Z"
  }
  ```

#### 3.1.5 查詢角色按鈕列表
- **HTTP 方法**: `GET`
- **路徑**: `/api/v1/roles/{roleId}/buttons`
- **說明**: 查詢指定角色在指定作業下的按鈕列表
- **路徑參數**:
  - `roleId`: 角色代碼
- **請求參數**:
  - `programId`: 作業代碼（可選）
- **回應格式**:
  ```json
  {
    "success": true,
    "code": 200,
    "message": "查詢成功",
    "data": [
      {
        "buttonKey": 1001,
        "buttonName": "新增",
        "programId": "SYS0110",
        "funs": "I",
        "pageId": "SYS0110_FI",
        "isAuthorized": true
      }
    ],
    "timestamp": "2024-01-01T00:00:00Z"
  }
  ```

#### 3.1.6 新增角色權限
- **HTTP 方法**: `POST`
- **路徑**: `/api/v1/roles/{roleId}/permissions`
- **說明**: 為指定角色新增權限（可批量）
- **路徑參數**:
  - `roleId`: 角色代碼
- **請求格式**:
  ```json
  {
    "buttonKeys": [1001, 1002, 1003]
  }
  ```
- **回應格式**:
  ```json
  {
    "success": true,
    "code": 200,
    "message": "新增成功",
    "data": {
      "addedCount": 3,
      "skippedCount": 0
    },
    "timestamp": "2024-01-01T00:00:00Z"
  }
  ```

#### 3.1.7 設定角色系統權限（批量）
- **HTTP 方法**: `POST`
- **路徑**: `/api/v1/roles/{roleId}/systems/permissions`
- **說明**: 批量設定角色對系統的權限（全選/未選）
- **路徑參數**:
  - `roleId`: 角色代碼
- **請求格式**:
  ```json
  {
    "systemPermissions": [
      {
        "systemId": "SYS001",
        "isAuthorized": true
      },
      {
        "systemId": "SYS002",
        "isAuthorized": false
      }
    ]
  }
  ```
- **回應格式**:
  ```json
  {
    "success": true,
    "code": 200,
    "message": "設定成功",
    "data": {
      "updatedCount": 2
    },
    "timestamp": "2024-01-01T00:00:00Z"
  }
  ```

#### 3.1.8 設定角色選單權限（批量）
- **HTTP 方法**: `POST`
- **路徑**: `/api/v1/roles/{roleId}/menus/permissions`
- **說明**: 批量設定角色對選單的權限
- **路徑參數**:
  - `roleId`: 角色代碼
- **請求格式**:
  ```json
  {
    "menuPermissions": [
      {
        "menuId": "MENU001",
        "isAuthorized": true
      }
    ]
  }
  ```
- **回應格式**:
  ```json
  {
    "success": true,
    "code": 200,
    "message": "設定成功",
    "data": {
      "updatedCount": 1
    },
    "timestamp": "2024-01-01T00:00:00Z"
  }
  ```

#### 3.1.9 設定角色作業權限（批量）
- **HTTP 方法**: `POST`
- **路徑**: `/api/v1/roles/{roleId}/programs/permissions`
- **說明**: 批量設定角色對作業的權限
- **路徑參數**:
  - `roleId`: 角色代碼
- **請求格式**:
  ```json
  {
    "programPermissions": [
      {
        "programId": "SYS0110",
        "isAuthorized": true
      }
    ]
  }
  ```
- **回應格式**:
  ```json
  {
    "success": true,
    "code": 200,
    "message": "設定成功",
    "data": {
      "updatedCount": 1
    },
    "timestamp": "2024-01-01T00:00:00Z"
  }
  ```

#### 3.1.10 設定角色按鈕權限（批量）
- **HTTP 方法**: `POST`
- **路徑**: `/api/v1/roles/{roleId}/buttons/permissions`
- **說明**: 批量設定角色對按鈕的權限
- **路徑參數**:
  - `roleId`: 角色代碼
- **請求格式**:
  ```json
  {
    "buttonPermissions": [
      {
        "buttonKey": 1001,
        "isAuthorized": true
      },
      {
        "buttonKey": 1002,
        "isAuthorized": false
      }
    ]
  }
  ```
- **回應格式**:
  ```json
  {
    "success": true,
    "code": 200,
    "message": "設定成功",
    "data": {
      "updatedCount": 2
    },
    "timestamp": "2024-01-01T00:00:00Z"
  }
  ```

#### 3.1.11 修改角色權限
- **HTTP 方法**: `PUT`
- **路徑**: `/api/v1/roles/{roleId}/permissions/{tKey}`
- **說明**: 修改單筆角色權限
- **路徑參數**:
  - `roleId`: 角色代碼
  - `tKey`: 權限主鍵
- **請求格式**:
  ```json
  {
    "buttonKey": 1002
  }
  ```
- **回應格式**:
  ```json
  {
    "success": true,
    "code": 200,
    "message": "修改成功",
    "data": {
      "tKey": 1,
      "roleId": "ROLE001",
      "buttonKey": 1002
    },
    "timestamp": "2024-01-01T00:00:00Z"
  }
  ```

#### 3.1.12 刪除角色權限
- **HTTP 方法**: `DELETE`
- **路徑**: `/api/v1/roles/{roleId}/permissions/{tKey}`
- **說明**: 刪除單筆角色權限
- **路徑參數**:
  - `roleId`: 角色代碼
  - `tKey`: 權限主鍵
- **回應格式**:
  ```json
  {
    "success": true,
    "code": 200,
    "message": "刪除成功",
    "data": null,
    "timestamp": "2024-01-01T00:00:00Z"
  }
  ```

#### 3.1.13 批量刪除角色權限
- **HTTP 方法**: `DELETE`
- **路徑**: `/api/v1/roles/{roleId}/permissions`
- **說明**: 批量刪除角色權限
- **路徑參數**:
  - `roleId`: 角色代碼
- **請求格式**:
  ```json
  {
    "tKeys": [1, 2, 3]
  }
  ```
- **回應格式**:
  ```json
  {
    "success": true,
    "code": 200,
    "message": "刪除成功",
    "data": {
      "deletedCount": 3
    },
    "timestamp": "2024-01-01T00:00:00Z"
  }
  ```

---

## 四、前端 UI 設計

### 4.1 主要頁面

#### 4.1.1 角色權限查詢頁面 (`/sys/roles/{roleId}/permissions`)
- **功能**: 查詢指定角色的權限列表
- **主要元件**:
  - 角色選擇下拉選單
  - 權限列表表格（支援分頁、排序）
  - 篩選條件（系統、選單、作業、按鈕）
  - 操作按鈕（新增、修改、刪除、批量設定）

#### 4.1.2 角色系統權限設定頁面 (`/sys/roles/{roleId}/systems`)
- **功能**: 設定角色對系統的權限
- **主要元件**:
  - 系統列表表格
  - 每行顯示：序號、全選/未選複選框、系統代碼、系統名稱、權限統計
  - 權限統計顯示：總按鈕數、已授權按鈕數、授權率
  - 操作按鈕：開始查詢、設定權限、重新設定、重新設定其他角色

#### 4.1.3 角色選單權限設定頁面 (`/sys/roles/{roleId}/menus`)
- **功能**: 設定角色對選單的權限
- **主要元件**:
  - 選單樹狀結構
  - 每項顯示：選單名稱、權限統計、全選/未選複選框
  - 支援展開/收合

#### 4.1.4 角色作業權限設定頁面 (`/sys/roles/{roleId}/programs`)
- **功能**: 設定角色對作業的權限
- **主要元件**:
  - 作業列表表格
  - 每行顯示：作業代碼、作業名稱、權限統計、全選/未選複選框

#### 4.1.5 角色按鈕權限設定頁面 (`/sys/roles/{roleId}/buttons`)
- **功能**: 設定角色對按鈕的權限
- **主要元件**:
  - 按鈕列表表格
  - 每行顯示：按鈕名稱、功能代碼、是否授權複選框

#### 4.1.6 角色權限新增/修改頁面 (`/sys/roles/{roleId}/permissions/new`, `/sys/roles/{roleId}/permissions/{tKey}/edit`)
- **功能**: 新增或修改單筆角色權限
- **主要元件**:
  - 角色代碼下拉選單（新增時可選，修改時唯讀）
  - 按鈕選擇下拉選單（多選）
  - 表單驗證
  - 儲存、取消按鈕

### 4.2 UI 元件設計

#### 4.2.1 權限統計元件
- **顯示內容**:
  - 總按鈕數
  - 已授權按鈕數
  - 授權率（百分比）
  - 是否全選狀態

#### 4.2.2 權限設定複選框
- **狀態**:
  - 全選：所有按鈕已授權
  - 部分選取：部分按鈕已授權
  - 未選：無按鈕授權

#### 4.2.3 批量操作工具列
- **功能按鈕**:
  - 全選
  - 取消全選
  - 批量授權
  - 批量取消授權
  - 刪除選取項目

### 4.3 互動流程

#### 4.3.1 系統權限設定流程
1. 選擇角色
2. 顯示系統列表（含權限統計）
3. 勾選/取消勾選系統
4. 點擊「設定權限」
5. 系統自動設定該系統下所有按鈕的權限
6. 顯示設定結果

#### 4.3.2 選單權限設定流程
1. 選擇角色和系統
2. 顯示選單樹狀結構
3. 勾選/取消勾選選單
4. 點擊「設定權限」
5. 系統自動設定該選單下所有按鈕的權限

#### 4.3.3 作業權限設定流程
1. 選擇角色和選單
2. 顯示作業列表
3. 勾選/取消勾選作業
4. 點擊「設定權限」
5. 系統自動設定該作業下所有按鈕的權限

#### 4.3.4 按鈕權限設定流程
1. 選擇角色和作業
2. 顯示按鈕列表
3. 勾選/取消勾選個別按鈕
4. 點擊「設定權限」
5. 儲存按鈕權限設定

---

## 五、業務邏輯

### 5.1 權限繼承規則
- 當設定系統權限為「全選」時，自動授權該系統下所有按鈕
- 當設定選單權限為「全選」時，自動授權該選單下所有按鈕
- 當設定作業權限為「全選」時，自動授權該作業下所有按鈕
- 當取消上層權限時，需確認是否同時取消下層權限

### 5.2 權限統計計算
- 系統權限統計：統計該系統下所有啟用作業的所有啟用按鈕
- 選單權限統計：統計該選單下所有啟用作業的所有啟用按鈕
- 作業權限統計：統計該作業下所有啟用按鈕
- 授權率 = 已授權按鈕數 / 總按鈕數

### 5.3 權限驗證
- 新增權限前需檢查角色是否存在
- 新增權限前需檢查按鈕是否存在
- 新增權限前需檢查是否已存在相同權限（避免重複）
- 修改權限前需檢查權限記錄是否存在
- 刪除權限前需檢查權限記錄是否存在

### 5.4 批量操作邏輯
- 批量設定系統權限：根據系統ID列表，批量新增或刪除該系統下所有按鈕的權限
- 批量設定選單權限：根據選單ID列表，批量新增或刪除該選單下所有按鈕的權限
- 批量設定作業權限：根據作業ID列表，批量新增或刪除該作業下所有按鈕的權限
- 批量設定按鈕權限：根據按鈕Key列表，批量新增或刪除按鈕權限

---

## 六、錯誤處理

### 6.1 驗證錯誤
- 角色代碼為空：`ERR_ROLE_ID_REQUIRED`
- 按鈕Key為空：`ERR_BUTTON_KEY_REQUIRED`
- 角色不存在：`ERR_ROLE_NOT_FOUND`
- 按鈕不存在：`ERR_BUTTON_NOT_FOUND`
- 權限已存在：`ERR_PERMISSION_ALREADY_EXISTS`

### 6.2 業務錯誤
- 無權限操作：`ERR_NO_PERMISSION`
- 批量操作失敗：`ERR_BATCH_OPERATION_FAILED`

### 6.3 系統錯誤
- 資料庫連線失敗：`ERR_DATABASE_CONNECTION`
- 交易失敗：`ERR_TRANSACTION_FAILED`

---

## 七、測試計劃

### 7.1 單元測試
- 權限新增功能測試
- 權限修改功能測試
- 權限刪除功能測試
- 權限查詢功能測試
- 批量權限設定功能測試
- 權限統計計算測試

### 7.2 整合測試
- API 端點整合測試
- 權限繼承邏輯測試
- 批量操作交易測試

### 7.3 效能測試
- 大量權限資料查詢效能測試
- 批量權限設定效能測試

---

## 八、開發時程

### 8.1 第一階段：基礎功能（2週）
- 資料庫設計與建立
- 基礎 CRUD API 開發
- 基礎 UI 頁面開發

### 8.2 第二階段：批量設定功能（2週）
- 系統權限批量設定
- 選單權限批量設定
- 作業權限批量設定
- 按鈕權限批量設定

### 8.3 第三階段：權限統計與顯示（1週）
- 權限統計計算邏輯
- 權限統計 UI 顯示

### 8.4 第四階段：測試與優化（1週）
- 單元測試
- 整合測試
- 效能優化

**總計：6週**

