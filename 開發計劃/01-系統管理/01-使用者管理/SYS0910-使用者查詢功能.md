# SYS0910 - 使用者查詢功能 開發計劃

## 一、功能概述

### 1.1 功能說明
- **功能代碼**: SYS0910
- **功能名稱**: 使用者查詢功能
- **功能描述**: 提供使用者資料的查詢功能，支援多條件查詢、排序、分頁等功能，僅供查詢，不支援新增、修改、刪除操作
- **參考舊程式**: 
  - `WEB/IMS_CORE/ASP/SYS0000/SYS0910.asp` (查詢頁面)
  - `WEB/IMS_CORE/ASP/SYS0000/SYS0910-2.asp` (查詢頁面版本2)

### 1.2 業務需求
- 提供使用者資料的查詢功能
- 支援多條件組合查詢
- 支援查詢結果的排序
- 支援查詢結果的分頁顯示
- 支援查詢結果的匯出功能
- 不支援資料的新增、修改、刪除操作

---

## 二、資料庫設計 (Schema)

### 2.1 主要資料表: `Users`
與 SYS0110 共用相同的資料表結構，請參考 SYS0110 的資料庫設計。

### 2.2 查詢視圖
本功能主要使用查詢功能，不需要額外的資料表設計。

---

## 三、後端 API 設計

### 3.1 API 端點列表

#### 3.1.1 查詢使用者列表
- **HTTP 方法**: `GET`
- **路徑**: `/api/v1/users/query`
- **說明**: 查詢使用者列表，支援多條件查詢、排序、分頁
- **請求參數**:
  ```json
  {
    "pageIndex": 1,
    "pageSize": 20,
    "sortField": "UserId",
    "sortOrder": "ASC",
    "filters": {
      "userId": "",
      "userName": "",
      "orgId": "",
      "status": "",
      "userType": "",
      "title": "",
      "shopId": ""
    }
  }
  ```
- **回應格式**: 標準列表回應格式

#### 3.1.2 查詢單筆使用者
- **HTTP 方法**: `GET`
- **路徑**: `/api/v1/users/{userId}/query`
- **說明**: 根據使用者編號查詢單筆使用者資料
- **路徑參數**:
  - `userId`: 使用者編號
- **回應格式**: 標準單筆回應格式

#### 3.1.3 匯出查詢結果
- **HTTP 方法**: `POST`
- **路徑**: `/api/v1/users/query/export`
- **說明**: 匯出查詢結果 (Excel/PDF)
- **請求格式**: 同查詢參數
- **回應格式**: 檔案下載

---

## 四、前端 UI 設計

### 4.1 頁面結構

#### 4.1.1 使用者查詢頁面 (`UserQuery.vue`)
- **路徑**: `/system/users/query`
- **功能**: 顯示使用者查詢表單與結果列表
- **主要元件**:
  - 查詢表單 (UserQuerySearchForm)
  - 資料表格 (UserQueryDataTable)
  - 匯出按鈕

### 4.2 主要元件

#### 4.2.1 查詢表單元件
- 使用者代碼
- 使用者名稱
- 組織代碼
- 狀態
- 使用者類型
- 職稱
- 店別代碼
- 查詢、重置、匯出按鈕

#### 4.2.2 資料表格元件
- 顯示使用者代碼、使用者名稱、組織、狀態、使用者類型、職稱、店別等欄位
- 支援排序、分頁

---

## 五、開發時程

**總計**: 8天
- 資料庫設計: 1天（共用SYS0110的資料表）
- 後端API開發: 2天
- 前端UI開發: 3天
- 測試與修正: 2天

---

## 六、注意事項

### 6.1 安全性
- 必須驗證使用者權限
- 僅供查詢，不支援新增、修改、刪除操作

### 6.2 效能
- 查詢結果需支援分頁
- 大量資料需使用索引優化

### 6.3 業務邏輯
- 與 SYS0110 共用相同的資料表
- 查詢功能與 SYS0140 類似，但可能有不同的查詢條件或顯示方式

---

## 七、測試案例

### 7.1 單元測試
- [ ] 查詢使用者列表成功
- [ ] 多條件組合查詢成功
- [ ] 排序功能正常
- [ ] 分頁功能正常
- [ ] 匯出 Excel 報表成功
- [ ] 匯出 PDF 報表成功

---

## 八、參考資料

### 8.1 舊程式碼
- `WEB/IMS_CORE/ASP/SYS0000/SYS0910.asp`
- `WEB/IMS_CORE/ASP/SYS0000/SYS0910-2.asp`

### 8.2 相關功能
- SYS0110 - 使用者基本資料維護
- SYS0120 - 使用者資料瀏覽
- SYS0140 - 使用者資料查詢

---

**文件版本**: v1.0  
**建立日期**: 2024-01-01  
**最後更新**: 2024-01-01

