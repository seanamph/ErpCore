# CFG0410 - 主系統項目資料維護 開發計劃

## 一、功能概述

### 1.1 功能說明
- **功能代碼**: CFG0410
- **功能名稱**: 主系統項目資料維護
- **功能描述**: 提供配置模組主系統項目資料的新增、修改、刪除、查詢功能，包含主系統代碼、主系統名稱、系統型態、伺服器主機名稱等資訊管理
- **參考舊程式**: 
  - `IMS3/HANSHIN/IMS3/CFG0000/CFG0410_FI1.aspx` (新增)
  - `IMS3/HANSHIN/IMS3/CFG0000/CFG0410_FU1.aspx` (修改)
  - `IMS3/HANSHIN/IMS3/CFG0000/CFG0410_FD.aspx` (刪除)
  - `IMS3/HANSHIN/IMS3/CFG0000/CFG0410_PR.aspx` (報表)
  - `WEB/IMS_CORE/CFG0000/CFG0410_PR.rdlc` (報表定義)

### 1.2 業務需求
- 管理配置模組主系統項目資訊
- 支援主系統的新增、修改、刪除、查詢
- 記錄主系統的建立與變更資訊
- 支援系統型態設定
- 支援排序序號設定
- 與子系統、作業、按鈕權限系統整合

---

## 二、資料庫設計 (Schema)

### 2.1 主要資料表: `ConfigSystems` (對應舊系統配置模組主系統)

```sql
CREATE TABLE [dbo].[ConfigSystems] (
    [SystemId] NVARCHAR(50) NOT NULL PRIMARY KEY, -- 主系統代碼 (SYS_ID)
    [SystemName] NVARCHAR(100) NOT NULL, -- 主系統名稱 (SYS_NAME)
    [SeqNo] INT NULL, -- 排序序號 (SEQ_NO)
    [SystemType] NVARCHAR(20) NULL, -- 系統型態 (SYS_TYPE)
    [ServerIp] NVARCHAR(100) NULL, -- 伺服器主機名稱 (SERVER_IP)
    [ModuleId] NVARCHAR(50) NULL, -- 模組代碼 (MODULE_ID)
    [DbUser] NVARCHAR(50) NULL, -- 資料庫使用者 (DB_USER)
    [DbPass] NVARCHAR(255) NULL, -- 資料庫密碼 (DB_PASS，加密儲存)
    [Notes] NVARCHAR(500) NULL, -- 備註 (NOTES)
    [Status] NVARCHAR(10) NULL DEFAULT 'A', -- 狀態 (STATUS)
    [CreatedBy] NVARCHAR(50) NULL, -- 建立者 (BUSER)
    [CreatedAt] DATETIME2 NOT NULL DEFAULT GETDATE(), -- 建立時間 (BTIME)
    [UpdatedBy] NVARCHAR(50) NULL, -- 更新者 (CUSER)
    [UpdatedAt] DATETIME2 NOT NULL DEFAULT GETDATE(), -- 更新時間 (CTIME)
    [CreatedPriority] INT NULL, -- 建立者等級 (CPRIORITY)
    [CreatedGroup] NVARCHAR(50) NULL, -- 建立者群組 (CGROUP)
    CONSTRAINT [PK_ConfigSystems] PRIMARY KEY CLUSTERED ([SystemId] ASC)
);

-- 索引
CREATE NONCLUSTERED INDEX [IX_ConfigSystems_SystemName] ON [dbo].[ConfigSystems] ([SystemName]);
CREATE NONCLUSTERED INDEX [IX_ConfigSystems_SystemType] ON [dbo].[ConfigSystems] ([SystemType]);
CREATE NONCLUSTERED INDEX [IX_ConfigSystems_SeqNo] ON [dbo].[ConfigSystems] ([SeqNo]);
```

---

## 三、後端 API 設計

### 3.1 API 端點列表

#### 3.1.1 查詢主系統列表
- **HTTP 方法**: `GET`
- **路徑**: `/api/v1/config/systems`
- **說明**: 查詢配置模組主系統列表，支援分頁、排序、篩選

#### 3.1.2 查詢單筆主系統
- **HTTP 方法**: `GET`
- **路徑**: `/api/v1/config/systems/{systemId}`
- **說明**: 根據主系統代碼查詢單筆主系統資料

#### 3.1.3 新增主系統
- **HTTP 方法**: `POST`
- **路徑**: `/api/v1/config/systems`
- **說明**: 新增主系統資料

#### 3.1.4 修改主系統
- **HTTP 方法**: `PUT`
- **路徑**: `/api/v1/config/systems/{systemId}`
- **說明**: 修改主系統資料

#### 3.1.5 刪除主系統
- **HTTP 方法**: `DELETE`
- **路徑**: `/api/v1/config/systems/{systemId}`
- **說明**: 刪除主系統資料

---

## 四、前端 UI 設計

### 4.1 頁面結構
- 查詢條件區塊：主系統代碼、主系統名稱、系統型態、狀態
- 資料表格區塊：主系統列表表格
- 新增/修改表單：主系統資料維護表單

### 4.2 元件設計
- 參考 SYS0410 的元件設計結構

---

## 五、實作細節

### 5.1 後端實作
- Repository: `IConfigSystemRepository` / `ConfigSystemRepository`
- Service: `IConfigSystemService` / `ConfigSystemService`
- Controller: `ConfigSystemController`

### 5.2 前端實作
- API 服務: `configSystemApi.ts`
- 頁面元件: `CFG0410ConfigSystem.vue`

---

## 六、相關文件
- [SYS0410-主系統項目資料維護](../01-系統管理/04-系統設定/SYS0410-主系統項目資料維護.md)
- [CFG0420-子系統項目資料維護](./CFG0420-子系統項目資料維護.md)

