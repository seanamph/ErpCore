# SYS3310-SYS3320 - 會員資料維護系列 開發計劃

## 一、功能概述

### 1.1 功能說明
- **功能代碼**: SYS3310-SYS3320 系列
- **功能名稱**: 會員資料維護系列
- **功能描述**: 提供會員基本資料的新增、修改、刪除、查詢功能，包含會員編號、會員姓名、聯絡資訊、會員等級、積分、狀態等資訊管理
- **參考舊程式**: 
  - `WEB/IMS_CORE/ASP/SYS3000/SYS3310_FB.ASP` (瀏覽)
  - `WEB/IMS_CORE/ASP/SYS3000/SYS3310_FI.ASP` (新增)
  - `WEB/IMS_CORE/ASP/SYS3000/SYS3310_FU.ASP` (修改)
  - `WEB/IMS_CORE/ASP/SYS3000/SYS3310_FD.ASP` (刪除)
  - `WEB/IMS_CORE/ASP/SYS3000/SYS3310_FQ.ASP` (查詢)
  - `WEB/IMS_CORE/ASP/SYS3000/SYS3310_PR.ASP` (報表)
  - `WEB/IMS_CORE/ASP/SYS3000/SYS3315_*.ASP` (會員相關功能)
  - `WEB/IMS_CORE/ASP/SYS3000/SYS3316_*.ASP` (會員相關功能)
  - `WEB/IMS_CORE/ASP/SYS3000/SYS3317_*.ASP` (會員相關功能)
  - `WEB/IMS_CORE/ASP/SYS3000/SYS3320_*.ASP` (會員相關功能)

### 1.2 業務需求
- 管理會員基本資料資訊
- 支援會員的新增、修改、刪除、查詢
- 記錄會員的建立與變更資訊
- 支援會員等級管理
- 支援積分管理
- 支援會員照片上傳
- 支援會員狀態管理（啟用/停用）
- 支援會員卡片管理

---

## 二、資料庫設計 (Schema)

### 2.1 主要資料表: `Members`

```sql
CREATE TABLE [dbo].[Members] (
    [TKey] BIGINT NOT NULL PRIMARY KEY IDENTITY(1,1),
    [MemberId] NVARCHAR(50) NOT NULL, -- 會員編號
    [MemberName] NVARCHAR(100) NOT NULL, -- 會員姓名
    [MemberNameEn] NVARCHAR(100) NULL, -- 會員英文姓名
    [Gender] NVARCHAR(10) NULL, -- 性別 (M:男, F:女)
    [BirthDate] DATETIME2 NULL, -- 生日
    [PersonalId] NVARCHAR(50) NULL, -- 身份證字號
    [Phone] NVARCHAR(50) NULL, -- 電話
    [Mobile] NVARCHAR(50) NULL, -- 手機
    [Email] NVARCHAR(100) NULL, -- 電子郵件
    [Address] NVARCHAR(500) NULL, -- 地址
    [City] NVARCHAR(50) NULL, -- 城市
    [Zone] NVARCHAR(50) NULL, -- 區域
    [PostalCode] NVARCHAR(20) NULL, -- 郵遞區號
    [MemberLevel] NVARCHAR(50) NULL, -- 會員等級
    [Points] DECIMAL(18, 4) NULL DEFAULT 0, -- 積分
    [TotalPoints] DECIMAL(18, 4) NULL DEFAULT 0, -- 累計積分
    [CardNo] NVARCHAR(50) NULL, -- 卡片號碼
    [CardType] NVARCHAR(50) NULL, -- 卡片類型
    [JoinDate] DATETIME2 NULL, -- 加入日期
    [ExpireDate] DATETIME2 NULL, -- 到期日期
    [Status] NVARCHAR(10) NOT NULL DEFAULT 'A', -- 狀態 (A:啟用, I:停用, S:暫停)
    [PhotoPath] NVARCHAR(500) NULL, -- 照片路徑
    [Notes] NVARCHAR(1000) NULL, -- 備註
    [CreatedBy] NVARCHAR(50) NULL,
    [CreatedAt] DATETIME2 NOT NULL DEFAULT GETDATE(),
    [UpdatedBy] NVARCHAR(50) NULL,
    [UpdatedAt] DATETIME2 NOT NULL DEFAULT GETDATE(),
    CONSTRAINT [PK_Members] PRIMARY KEY CLUSTERED ([TKey] ASC),
    CONSTRAINT [UQ_Members_MemberId] UNIQUE ([MemberId])
);

-- 索引
CREATE NONCLUSTERED INDEX [IX_Members_MemberId] ON [dbo].[Members] ([MemberId]);
CREATE NONCLUSTERED INDEX [IX_Members_MemberName] ON [dbo].[Members] ([MemberName]);
CREATE NONCLUSTERED INDEX [IX_Members_PersonalId] ON [dbo].[Members] ([PersonalId]);
CREATE NONCLUSTERED INDEX [IX_Members_Phone] ON [dbo].[Members] ([Phone]);
CREATE NONCLUSTERED INDEX [IX_Members_Mobile] ON [dbo].[Members] ([Mobile]);
CREATE NONCLUSTERED INDEX [IX_Members_Email] ON [dbo].[Members] ([Email]);
CREATE NONCLUSTERED INDEX [IX_Members_MemberLevel] ON [dbo].[Members] ([MemberLevel]);
CREATE NONCLUSTERED INDEX [IX_Members_Status] ON [dbo].[Members] ([Status]);
CREATE NONCLUSTERED INDEX [IX_Members_CardNo] ON [dbo].[Members] ([CardNo]);
```

### 2.2 相關資料表

#### 2.2.1 `MemberLevels` - 會員等級
```sql
CREATE TABLE [dbo].[MemberLevels] (
    [LevelId] NVARCHAR(50) NOT NULL PRIMARY KEY,
    [LevelName] NVARCHAR(100) NOT NULL,
    [LevelNameEn] NVARCHAR(100) NULL,
    [MinPoints] DECIMAL(18, 4) NULL DEFAULT 0, -- 最低積分
    [MaxPoints] DECIMAL(18, 4) NULL, -- 最高積分
    [DiscountRate] DECIMAL(5, 2) NULL DEFAULT 0, -- 折扣率
    [Description] NVARCHAR(500) NULL,
    [Status] NVARCHAR(10) NOT NULL DEFAULT 'A',
    [CreatedBy] NVARCHAR(50) NULL,
    [CreatedAt] DATETIME2 NOT NULL DEFAULT GETDATE(),
    [UpdatedBy] NVARCHAR(50) NULL,
    [UpdatedAt] DATETIME2 NOT NULL DEFAULT GETDATE()
);
```

#### 2.2.2 `MemberCards` - 會員卡片
```sql
CREATE TABLE [dbo].[MemberCards] (
    [CardId] NVARCHAR(50) NOT NULL PRIMARY KEY,
    [MemberId] NVARCHAR(50) NOT NULL,
    [CardNo] NVARCHAR(50) NOT NULL,
    [CardType] NVARCHAR(50) NULL,
    [IssueDate] DATETIME2 NULL,
    [ExpireDate] DATETIME2 NULL,
    [Status] NVARCHAR(10) NOT NULL DEFAULT 'A', -- A:啟用, I:停用, L:遺失
    [CreatedBy] NVARCHAR(50) NULL,
    [CreatedAt] DATETIME2 NOT NULL DEFAULT GETDATE(),
    [UpdatedBy] NVARCHAR(50) NULL,
    [UpdatedAt] DATETIME2 NOT NULL DEFAULT GETDATE(),
    CONSTRAINT [FK_MemberCards_Members] FOREIGN KEY ([MemberId]) REFERENCES [dbo].[Members] ([MemberId]) ON DELETE CASCADE
);

-- 索引
CREATE NONCLUSTERED INDEX [IX_MemberCards_MemberId] ON [dbo].[MemberCards] ([MemberId]);
CREATE NONCLUSTERED INDEX [IX_MemberCards_CardNo] ON [dbo].[MemberCards] ([CardNo]);
```

#### 2.2.3 `MemberPoints` - 會員積分記錄
```sql
CREATE TABLE [dbo].[MemberPoints] (
    [TKey] BIGINT NOT NULL PRIMARY KEY IDENTITY(1,1),
    [MemberId] NVARCHAR(50) NOT NULL,
    [TransactionDate] DATETIME2 NOT NULL,
    [TransactionType] NVARCHAR(20) NOT NULL, -- EARN:獲得, USE:使用, EXPIRE:過期, ADJUST:調整
    [Points] DECIMAL(18, 4) NOT NULL, -- 正數為獲得，負數為使用
    [Balance] DECIMAL(18, 4) NOT NULL, -- 餘額
    [ReferenceNo] NVARCHAR(50) NULL, -- 參考單號
    [Description] NVARCHAR(500) NULL,
    [CreatedBy] NVARCHAR(50) NULL,
    [CreatedAt] DATETIME2 NOT NULL DEFAULT GETDATE(),
    CONSTRAINT [FK_MemberPoints_Members] FOREIGN KEY ([MemberId]) REFERENCES [dbo].[Members] ([MemberId]) ON DELETE CASCADE
);

-- 索引
CREATE NONCLUSTERED INDEX [IX_MemberPoints_MemberId] ON [dbo].[MemberPoints] ([MemberId]);
CREATE NONCLUSTERED INDEX [IX_MemberPoints_TransactionDate] ON [dbo].[MemberPoints] ([TransactionDate]);
CREATE NONCLUSTERED INDEX [IX_MemberPoints_TransactionType] ON [dbo].[MemberPoints] ([TransactionType]);
```

### 2.3 資料字典

#### 2.3.1 Members 資料表

| 欄位名稱 | 資料類型 | 長度 | 允許NULL | 預設值 | 說明 | 備註 |
|---------|---------|------|---------|--------|------|------|
| TKey | BIGINT | - | NO | IDENTITY | 主鍵 | 自動遞增 |
| MemberId | NVARCHAR | 50 | NO | - | 會員編號 | 唯一 |
| MemberName | NVARCHAR | 100 | NO | - | 會員姓名 | - |
| MemberNameEn | NVARCHAR | 100 | YES | - | 會員英文姓名 | - |
| Gender | NVARCHAR | 10 | YES | - | 性別 | M:男, F:女 |
| BirthDate | DATETIME2 | - | YES | - | 生日 | - |
| PersonalId | NVARCHAR | 50 | YES | - | 身份證字號 | - |
| Phone | NVARCHAR | 50 | YES | - | 電話 | - |
| Mobile | NVARCHAR | 50 | YES | - | 手機 | - |
| Email | NVARCHAR | 100 | YES | - | 電子郵件 | - |
| Address | NVARCHAR | 500 | YES | - | 地址 | - |
| City | NVARCHAR | 50 | YES | - | 城市 | - |
| Zone | NVARCHAR | 50 | YES | - | 區域 | - |
| PostalCode | NVARCHAR | 20 | YES | - | 郵遞區號 | - |
| MemberLevel | NVARCHAR | 50 | YES | - | 會員等級 | 外鍵至MemberLevels |
| Points | DECIMAL | 18,4 | YES | 0 | 積分 | - |
| TotalPoints | DECIMAL | 18,4 | YES | 0 | 累計積分 | - |
| CardNo | NVARCHAR | 50 | YES | - | 卡片號碼 | - |
| CardType | NVARCHAR | 50 | YES | - | 卡片類型 | - |
| JoinDate | DATETIME2 | - | YES | - | 加入日期 | - |
| ExpireDate | DATETIME2 | - | YES | - | 到期日期 | - |
| Status | NVARCHAR | 10 | NO | 'A' | 狀態 | A:啟用, I:停用, S:暫停 |
| PhotoPath | NVARCHAR | 500 | YES | - | 照片路徑 | - |
| Notes | NVARCHAR | 1000 | YES | - | 備註 | - |

---

## 三、後端 API 設計

### 3.1 API 端點列表

#### 3.1.1 查詢會員列表
- **HTTP 方法**: `GET`
- **路徑**: `/api/v1/members`
- **說明**: 查詢會員列表，支援分頁、排序、篩選
- **請求參數**:
  ```json
  {
    "pageIndex": 1,
    "pageSize": 20,
    "sortField": "MemberId",
    "sortOrder": "ASC",
    "filters": {
      "memberId": "",
      "memberName": "",
      "personalId": "",
      "phone": "",
      "mobile": "",
      "email": "",
      "memberLevel": "",
      "status": "",
      "cardNo": ""
    }
  }
  ```
- **回應格式**:
  ```json
  {
    "success": true,
    "code": 200,
    "message": "查詢成功",
    "data": {
      "items": [
        {
          "tKey": 1,
          "memberId": "M001",
          "memberName": "張三",
          "memberNameEn": "Zhang San",
          "gender": "M",
          "birthDate": "1990-01-01",
          "phone": "02-12345678",
          "mobile": "0912345678",
          "email": "test@example.com",
          "memberLevel": "GOLD",
          "points": 1000.00,
          "totalPoints": 5000.00,
          "cardNo": "CARD001",
          "status": "A",
          "joinDate": "2024-01-01"
        }
      ],
      "totalCount": 100,
      "pageIndex": 1,
      "pageSize": 20,
      "totalPages": 5
    },
    "timestamp": "2024-01-01T00:00:00Z"
  }
  ```

#### 3.1.2 查詢單筆會員
- **HTTP 方法**: `GET`
- **路徑**: `/api/v1/members/{memberId}`
- **說明**: 根據會員編號查詢單筆會員資料
- **路徑參數**:
  - `memberId`: 會員編號
- **回應格式**: 同查詢列表單筆資料格式

#### 3.1.3 新增會員
- **HTTP 方法**: `POST`
- **路徑**: `/api/v1/members`
- **說明**: 新增會員資料
- **請求格式**:
  ```json
  {
    "memberId": "M001",
    "memberName": "張三",
    "memberNameEn": "Zhang San",
    "gender": "M",
    "birthDate": "1990-01-01",
    "personalId": "A123456789",
    "phone": "02-12345678",
    "mobile": "0912345678",
    "email": "test@example.com",
    "address": "測試地址",
    "city": "台北市",
    "zone": "信義區",
    "postalCode": "110",
    "memberLevel": "GOLD",
    "points": 0,
    "cardNo": "CARD001",
    "cardType": "VIP",
    "joinDate": "2024-01-01",
    "expireDate": "2025-01-01",
    "status": "A",
    "notes": "備註"
  }
  ```
- **回應格式**:
  ```json
  {
    "success": true,
    "code": 200,
    "message": "新增成功",
    "data": {
      "memberId": "M001"
    },
    "timestamp": "2024-01-01T00:00:00Z"
  }
  ```

#### 3.1.4 修改會員
- **HTTP 方法**: `PUT`
- **路徑**: `/api/v1/members/{memberId}`
- **說明**: 修改會員資料
- **路徑參數**:
  - `memberId`: 會員編號
- **請求格式**: 同新增，但 `memberId` 不可修改
- **回應格式**: 同新增

#### 3.1.5 刪除會員
- **HTTP 方法**: `DELETE`
- **路徑**: `/api/v1/members/{memberId}`
- **說明**: 刪除會員資料（軟刪除或硬刪除）
- **路徑參數**:
  - `memberId`: 會員編號
- **回應格式**:
  ```json
  {
    "success": true,
    "code": 200,
    "message": "刪除成功",
    "data": null,
    "timestamp": "2024-01-01T00:00:00Z"
  }
  ```

#### 3.1.6 批次刪除會員
- **HTTP 方法**: `DELETE`
- **路徑**: `/api/v1/members/batch`
- **說明**: 批次刪除多筆會員
- **請求格式**:
  ```json
  {
    "memberIds": ["M001", "M002", "M003"]
  }
  ```

#### 3.1.7 啟用/停用會員
- **HTTP 方法**: `PUT`
- **路徑**: `/api/v1/members/{memberId}/status`
- **說明**: 啟用或停用會員
- **請求格式**:
  ```json
  {
    "status": "A" // A:啟用, I:停用, S:暫停
  }
  ```

#### 3.1.8 上傳會員照片
- **HTTP 方法**: `POST`
- **路徑**: `/api/v1/members/{memberId}/photo`
- **說明**: 上傳會員照片
- **請求格式**: `multipart/form-data`
  - `photo`: 照片檔案
- **回應格式**:
  ```json
  {
    "success": true,
    "code": 200,
    "message": "上傳成功",
    "data": {
      "photoPath": "/uploads/members/M001/photo.jpg"
    },
    "timestamp": "2024-01-01T00:00:00Z"
  }
  ```

#### 3.1.9 查詢會員積分記錄
- **HTTP 方法**: `GET`
- **路徑**: `/api/v1/members/{memberId}/points`
- **說明**: 查詢會員積分記錄
- **請求參數**:
  ```json
  {
    "pageIndex": 1,
    "pageSize": 20,
    "transactionDateFrom": "",
    "transactionDateTo": "",
    "transactionType": ""
  }
  ```

### 3.2 後端實作類別

#### 3.2.1 Controller: `MembersController.cs`
```csharp
[ApiController]
[Route("api/v1/members")]
[Authorize]
public class MembersController : ControllerBase
{
    private readonly IMemberService _memberService;
    private readonly ILogger<MembersController> _logger;

    public MembersController(IMemberService memberService, ILogger<MembersController> logger)
    {
        _memberService = memberService;
        _logger = logger;
    }

    [HttpGet]
    public async Task<ActionResult<PagedResult<MemberDto>>> GetMembers([FromQuery] MemberQueryDto query)
    {
        var result = await _memberService.GetMembersAsync(query);
        return Ok(result);
    }

    [HttpGet("{memberId}")]
    public async Task<ActionResult<MemberDto>> GetMember(string memberId)
    {
        var result = await _memberService.GetMemberByIdAsync(memberId);
        if (result == null)
            return NotFound();
        return Ok(result);
    }

    [HttpPost]
    public async Task<ActionResult<MemberDto>> CreateMember([FromBody] CreateMemberDto dto)
    {
        var result = await _memberService.CreateMemberAsync(dto);
        return CreatedAtAction(nameof(GetMember), new { memberId = result.MemberId }, result);
    }

    [HttpPut("{memberId}")]
    public async Task<ActionResult<MemberDto>> UpdateMember(string memberId, [FromBody] UpdateMemberDto dto)
    {
        var result = await _memberService.UpdateMemberAsync(memberId, dto);
        if (result == null)
            return NotFound();
        return Ok(result);
    }

    [HttpDelete("{memberId}")]
    public async Task<ActionResult> DeleteMember(string memberId)
    {
        var success = await _memberService.DeleteMemberAsync(memberId);
        if (!success)
            return NotFound();
        return NoContent();
    }

    [HttpDelete("batch")]
    public async Task<ActionResult> DeleteMembers([FromBody] DeleteMembersDto dto)
    {
        await _memberService.DeleteMembersAsync(dto.MemberIds);
        return NoContent();
    }

    [HttpPut("{memberId}/status")]
    public async Task<ActionResult> UpdateMemberStatus(string memberId, [FromBody] UpdateMemberStatusDto dto)
    {
        var success = await _memberService.UpdateMemberStatusAsync(memberId, dto.Status);
        if (!success)
            return NotFound();
        return NoContent();
    }

    [HttpPost("{memberId}/photo")]
    public async Task<ActionResult<UploadPhotoResultDto>> UploadPhoto(string memberId, IFormFile photo)
    {
        var result = await _memberService.UploadPhotoAsync(memberId, photo);
        if (result == null)
            return NotFound();
        return Ok(result);
    }

    [HttpGet("{memberId}/points")]
    public async Task<ActionResult<PagedResult<MemberPointDto>>> GetMemberPoints(string memberId, [FromQuery] MemberPointQueryDto query)
    {
        var result = await _memberService.GetMemberPointsAsync(memberId, query);
        return Ok(result);
    }
}
```

#### 3.2.2 Service: `MemberService.cs`
```csharp
public interface IMemberService
{
    Task<PagedResult<MemberDto>> GetMembersAsync(MemberQueryDto query);
    Task<MemberDto> GetMemberByIdAsync(string memberId);
    Task<MemberDto> CreateMemberAsync(CreateMemberDto dto);
    Task<MemberDto> UpdateMemberAsync(string memberId, UpdateMemberDto dto);
    Task<bool> DeleteMemberAsync(string memberId);
    Task DeleteMembersAsync(List<string> memberIds);
    Task<bool> UpdateMemberStatusAsync(string memberId, string status);
    Task<UploadPhotoResultDto> UploadPhotoAsync(string memberId, IFormFile photo);
    Task<PagedResult<MemberPointDto>> GetMemberPointsAsync(string memberId, MemberPointQueryDto query);
}
```

#### 3.2.3 Repository: `MemberRepository.cs`
```csharp
public interface IMemberRepository
{
    Task<PagedResult<Member>> GetMembersAsync(MemberQueryDto query);
    Task<Member> GetMemberByIdAsync(string memberId);
    Task<Member> CreateMemberAsync(Member member);
    Task<Member> UpdateMemberAsync(Member member);
    Task<bool> DeleteMemberAsync(string memberId);
    Task DeleteMembersAsync(List<string> memberIds);
    Task<bool> UpdateMemberStatusAsync(string memberId, string status);
    Task UpdatePhotoPathAsync(string memberId, string photoPath);
    Task<PagedResult<MemberPoint>> GetMemberPointsAsync(string memberId, MemberPointQueryDto query);
}
```

---

## 四、前端 UI 設計

### 4.1 會員列表頁面 (`MembersList.vue`)

#### 4.1.1 頁面結構
- **搜尋區塊**: 會員編號、姓名、身份證、電話、手機、電子郵件、會員等級、狀態、卡片號碼
- **操作按鈕**: 新增、批次刪除、匯出、重新整理
- **資料表格**: 顯示會員列表，支援排序、分頁
- **操作欄**: 檢視、編輯、刪除、上傳照片、積分記錄

#### 4.1.2 主要元件
```vue
<template>
  <div class="members-list">
    <el-card>
      <template #header>
        <div class="card-header">
          <span>會員資料維護</span>
          <el-button type="primary" @click="handleAdd">新增</el-button>
        </div>
      </template>
      
      <!-- 搜尋區塊 -->
      <el-form :model="queryForm" inline>
        <el-form-item label="會員編號">
          <el-input v-model="queryForm.memberId" placeholder="請輸入會員編號" />
        </el-form-item>
        <el-form-item label="會員姓名">
          <el-input v-model="queryForm.memberName" placeholder="請輸入會員姓名" />
        </el-form-item>
        <el-form-item label="狀態">
          <el-select v-model="queryForm.status" placeholder="請選擇狀態">
            <el-option label="全部" value="" />
            <el-option label="啟用" value="A" />
            <el-option label="停用" value="I" />
            <el-option label="暫停" value="S" />
          </el-select>
        </el-form-item>
        <el-form-item>
          <el-button type="primary" @click="handleSearch">查詢</el-button>
          <el-button @click="handleReset">重置</el-button>
        </el-form-item>
      </el-form>
      
      <!-- 資料表格 -->
      <el-table
        :data="tableData"
        v-loading="loading"
        @selection-change="handleSelectionChange"
      >
        <el-table-column type="selection" width="55" />
        <el-table-column prop="memberId" label="會員編號" width="120" sortable />
        <el-table-column prop="memberName" label="會員姓名" width="150" sortable />
        <el-table-column prop="phone" label="電話" width="120" />
        <el-table-column prop="mobile" label="手機" width="120" />
        <el-table-column prop="email" label="電子郵件" width="200" />
        <el-table-column prop="memberLevel" label="會員等級" width="100" />
        <el-table-column prop="points" label="積分" width="100" align="right" />
        <el-table-column prop="status" label="狀態" width="80">
          <template #default="{ row }">
            <el-tag :type="getStatusType(row.status)">
              {{ getStatusText(row.status) }}
            </el-tag>
          </template>
        </el-table-column>
        <el-table-column label="操作" width="250" fixed="right">
          <template #default="{ row }">
            <el-button link type="primary" @click="handleView(row)">檢視</el-button>
            <el-button link type="primary" @click="handleEdit(row)">編輯</el-button>
            <el-button link type="primary" @click="handleUploadPhoto(row)">照片</el-button>
            <el-button link type="primary" @click="handlePoints(row)">積分</el-button>
            <el-button link type="danger" @click="handleDelete(row)">刪除</el-button>
          </template>
        </el-table-column>
      </el-table>
      
      <!-- 分頁 -->
      <el-pagination
        v-model:current-page="pagination.pageIndex"
        v-model:page-size="pagination.pageSize"
        :total="pagination.totalCount"
        :page-sizes="[10, 20, 50, 100]"
        layout="total, sizes, prev, pager, next, jumper"
        @size-change="handleSizeChange"
        @current-change="handlePageChange"
      />
    </el-card>
    
    <!-- 新增/編輯對話框 -->
    <MemberDialog
      v-model="dialogVisible"
      :member-id="currentMemberId"
      @success="handleDialogSuccess"
    />
    
    <!-- 照片上傳對話框 -->
    <PhotoUploadDialog
      v-model="photoDialogVisible"
      :member-id="currentMemberId"
      @success="handlePhotoUploadSuccess"
    />
    
    <!-- 積分記錄對話框 -->
    <PointsDialog
      v-model="pointsDialogVisible"
      :member-id="currentMemberId"
    />
  </div>
</template>
```

### 4.2 會員新增/編輯頁面 (`MemberDialog.vue`)

#### 4.2.1 表單欄位
- 基本資料: 會員編號、會員姓名、會員英文姓名、性別、生日、身份證字號
- 聯絡資訊: 電話、手機、電子郵件、地址、城市、區域、郵遞區號
- 會員資訊: 會員等級、積分、卡片號碼、卡片類型、加入日期、到期日期、狀態
- 其他: 備註

#### 4.2.2 表單驗證
- 會員編號: 必填、唯一
- 會員姓名: 必填
- 身份證字號: 格式驗證
- 電子郵件: 格式驗證
- 手機: 格式驗證

### 4.3 會員照片上傳頁面 (`PhotoUploadDialog.vue`)

#### 4.3.1 功能
- 照片上傳
- 照片預覽
- 照片刪除

### 4.4 會員積分記錄頁面 (`PointsDialog.vue`)

#### 4.4.1 功能
- 積分記錄列表
- 積分記錄查詢
- 積分記錄匯出

---

## 五、開發時程

### 5.1 第一階段: 資料庫設計與後端API (2週)
- 資料庫設計與建立
- Repository 實作
- Service 實作
- Controller 實作
- API 測試

### 5.2 第二階段: 前端UI開發 (2週)
- 會員列表頁面
- 會員新增/編輯頁面
- 會員照片上傳頁面
- 會員積分記錄頁面
- UI 測試

### 5.3 第三階段: 整合測試與優化 (1週)
- 前後端整合測試
- 效能優化
- 文件整理

**總計**: 5週

---

## 六、注意事項

### 6.1 資料安全
- 身份證字號需要加密儲存
- 個人資料需要符合個資法規範
- 照片上傳需要限制檔案大小與格式

### 6.2 業務邏輯
- 會員編號需要自動產生或手動輸入
- 會員等級需要根據積分自動更新
- 積分記錄需要完整記錄所有異動

### 6.3 效能考量
- 會員列表查詢需要建立適當的索引
- 大量資料查詢需要分頁處理
- 照片上傳需要非同步處理

---

## 七、測試案例

### 7.1 單元測試
- Repository 測試
- Service 測試
- Controller 測試

### 7.2 整合測試
- API 整合測試
- 前後端整合測試

### 7.3 功能測試
- 會員新增測試
- 會員修改測試
- 會員刪除測試
- 會員查詢測試
- 照片上傳測試
- 積分記錄測試

---

## 八、參考資料

### 8.1 舊程式參考
- `WEB/IMS_CORE/ASP/SYS3000/SYS3310_*.ASP`
- `WEB/IMS_CORE/ASP/SYS3000/SYS3315_*.ASP`
- `WEB/IMS_CORE/ASP/SYS3000/SYS3316_*.ASP`
- `WEB/IMS_CORE/ASP/SYS3000/SYS3317_*.ASP`
- `WEB/IMS_CORE/ASP/SYS3000/SYS3320_*.ASP`

### 8.2 相關文件
- 會員管理業務需求文件
- 個資法相關規範
- 照片上傳規範

---

**文件版本**: v1.0  
**建立日期**: 2024-01-01  
**最後更新**: 2024-01-01

