# SYS6501-SYS6560 - 類型代碼查詢系列 開發計劃

## 一、功能概述

### 1.1 功能說明
- **功能代碼**: SYS6501-SYS6560 系列
- **功能名稱**: 類型代碼查詢系列
- **功能描述**: 提供類型代碼資料的查詢、報表功能，包含類型代碼統計、類型代碼分布、類型代碼使用情況等查詢功能
- **參考舊程式**: 
  - `WEB/IMS_CORE/ASP/SYS6000/SYS6501_FQ.ASP` (查詢)
  - `WEB/IMS_CORE/ASP/SYS6000/SYS6501_PR.ASP` (報表)
  - `WEB/IMS_CORE/ASP/SYS6000/SYS6560_*.ASP` (類型代碼查詢相關功能)

### 1.2 業務需求
- 查詢類型代碼基本資料資訊
- 支援多條件組合查詢
- 支援類型代碼統計資訊查詢
- 支援類型代碼使用情況查詢
- 支援類型代碼報表列印
- 支援類型代碼資料匯出

---

## 二、資料庫設計 (Schema)

### 2.1 主要資料表: `TypeCodes` (類型代碼主檔)

參考 [SYS6405-SYS6490-類型代碼維護系列.md](./SYS6405-SYS6490-類型代碼維護系列.md) 中的資料表定義

### 2.2 相關資料表

#### 2.2.1 `TypeCodeUsage` - 類型代碼使用記錄（用於統計）
```sql
CREATE TABLE [dbo].[TypeCodeUsage] (
    [UsageId] BIGINT NOT NULL PRIMARY KEY IDENTITY(1,1),
    [TypeCodeId] NVARCHAR(50) NOT NULL,
    [ReferenceTable] NVARCHAR(100) NULL, -- 參考資料表
    [ReferenceId] NVARCHAR(50) NULL, -- 參考ID
    [UsageDate] DATETIME2 NULL,
    [CreatedBy] NVARCHAR(50) NULL,
    [CreatedAt] DATETIME2 NOT NULL DEFAULT GETDATE(),
    CONSTRAINT [FK_TypeCodeUsage_TypeCodes] FOREIGN KEY ([TypeCodeId]) REFERENCES [dbo].[TypeCodes] ([TypeCodeId])
);
```

---

## 三、後端 API 設計

### 3.1 API 端點列表

#### 3.1.1 查詢類型代碼列表
- **HTTP 方法**: `GET`
- **路徑**: `/api/v1/type-codes/query`
- **說明**: 查詢類型代碼列表，支援分頁、排序、篩選
- **請求參數**: 參考維護系列的查詢API
- **回應格式**: 參考維護系列的查詢API，但包含使用統計資訊

#### 3.1.2 類型代碼統計查詢
- **HTTP 方法**: `GET`
- **路徑**: `/api/v1/type-codes/statistics`
- **說明**: 查詢類型代碼統計資訊
- **請求參數**:
  ```json
  {
    "typeCategory": "",
    "includeUsageDetails": false
  }
  ```
- **回應格式**:
  ```json
  {
    "success": true,
    "code": 200,
    "message": "查詢成功",
    "data": {
      "totalTypeCodes": 100,
      "activeTypeCodes": 80,
      "categoryStatistics": [
        {
          "typeCategory": "BIG",
          "count": 10,
          "usageCount": 50
        }
      ]
    },
    "timestamp": "2024-01-01T00:00:00Z"
  }
  ```

#### 3.1.3 類型代碼報表查詢
- **HTTP 方法**: `GET`
- **路徑**: `/api/v1/type-codes/report`
- **說明**: 查詢類型代碼報表資料
- **請求參數**: 參考維護系列的報表API

---

## 四、前端 UI 設計

### 4.1 查詢頁面 (`TypeCodeQuery.vue`)

參考 [SYS6381-SYS63A0-樓層查詢作業系列.md](../02-樓層管理/SYS6381-SYS63A0-樓層查詢作業系列.md) 的查詢頁面設計

### 4.2 統計頁面 (`TypeCodeStatistics.vue`)

參考樓層查詢系列的統計頁面設計

---

## 五、開發時程

參考 [SYS6405-SYS6490-類型代碼維護系列.md](./SYS6405-SYS6490-類型代碼維護系列.md) 的開發時程

---

## 六、注意事項

參考維護系列的注意事項

---

## 七、測試案例

參考維護系列的測試案例

---

## 八、參考資料

### 8.1 相關開發計劃
- [SYS6405-SYS6490-類型代碼維護系列.md](./SYS6405-SYS6490-類型代碼維護系列.md)

### 8.2 技術文件
- Element Plus Table 文件
- ECharts 圖表庫文件

### 8.3 舊程式參考
- `WEB/IMS_CORE/ASP/SYS6000/SYS6501_*.ASP`
- `WEB/IMS_CORE/ASP/SYS6000/SYS6560_*.ASP`

